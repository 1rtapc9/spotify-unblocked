document.getElementById('search-btn').addEventListener('click', async () => {
  const query = document.getElementById('search-input').value;
  const type = document.getElementById('search-type').value;
  const resultsDiv = document.getElementById('results');
  resultsDiv.innerHTML = '';

  if (!query) return;

  // Use your Spotify token here if desired
  const token = 'YOUR_SPOTIFY_PUBLIC_TOKEN_HERE'; // replace with valid token
  const res = await fetch(`https://api.spotify.com/v1/search?q=${encodeURIComponent(query)}&type=${type}&limit=10`, {
    headers: { Authorization: `Bearer ${token}` }
  });
  const data = await res.json();

  if (type === 'track') {
    data.tracks.items.forEach(track => {
      const div = document.createElement('div');
      div.className = 'track';
      div.innerHTML = `<strong>${track.name}</strong> - ${track.artists[0].name}
      <iframe src="https://open.spotify.com/embed/track/${track.id}" width="300" height="80" frameborder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>`;
      resultsDiv.appendChild(div);
    });
  } else if (type === 'playlist') {
    data.playlists.items.forEach(pl => {
      const div = document.createElement('div');
      div.className = 'playlist';
      div.innerHTML = `<strong>${pl.name}</strong> - ${pl.tracks.total} tracks
      <iframe src="https://open.spotify.com/embed/playlist/${pl.id}" width="300" height="80" frameborder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>`;
      resultsDiv.appendChild(div);
    });
  } else if (type === 'album') {
    data.albums.items.forEach(album => {
      const div = document.createElement('div');
      div.className = 'playlist';
      div.innerHTML = `<strong>${album.name}</strong> - ${album.artists[0].name}
      <iframe src="https://open.spotify.com/embed/album/${album.id}" width="300" height="80" frameborder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>`;
      resultsDiv.appendChild(div);
    });
  } else if (type === 'artist') {
    data.artists.items.forEach(artist => {
      const div = document.createElement('div');
      div.className = 'artist flex';
      div.innerHTML = `<img src="${artist.images[0]?.url || ''}" alt="${artist.name}"><strong>${artist.name}</strong>`;
      resultsDiv.appendChild(div);
    });
  } else if (type === 'show') {
    data.shows.items.forEach(show => {
      const div = document.createElement('div');
      div.className = 'playlist';
      div.innerHTML = `<strong>${show.name}</strong>
      <iframe src="https://open.spotify.com/embed/show/${show.id}" width="300" height="80" frameborder="0" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>`;
      resultsDiv.appendChild(div);
    });
  }
});
